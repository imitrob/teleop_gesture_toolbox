<launch>

    <!-- These params will be merged with panda_description/config/testbed.yaml file somehow -->
    <arg name="robot" default="panda" /> <!-- 'panda'/('iiwa' not tested) -->
    <arg name="gripper" default="none" /> <!-- 'none'/'franka_hand'/'franka_hand_with_camera'-->
    <arg name="simulator" default="gazebo" /> <!-- 'real'/'gazebo'/'coppelia' -->
    <arg name="ik_solver" default="relaxed_ik" />

    <arg name="launch_ui" default="false" />
    <arg name="launch_leap" default="false" />
    <arg name="launch_gesture_detection" default="false" />

    <arg name="i_would_like_to_launch_sim_separately" default="true" />

    <!-- put parameters to the server-->
    <param name="mirracle_config/robot" type="str" value="$(arg robot)" />
    <param name="mirracle_config/gripper" type="str" value="$(arg gripper)" />
    <param name="mirracle_config/simulator" type="str" value="$(arg simulator)" />
    <param name="mirracle_config/launch_ui" type="str" value="$(arg launch_ui)" />
    <param name="mirracle_config/launch_leap" type="str" value="$(arg launch_leap)" />
    <param name="mirracle_config/launch_gesture_detection" type="str" value="$(arg launch_gesture_detection)" />


    <group if="$(eval arg('simulator') == 'gazebo' and arg('i_would_like_to_launch_sim_separately') == 'true')">
      <include file="$(find panda_gazebo)/launch/panda_world.launch" />
      <include file="$(find panda_sim_moveit)/launch/sim_move_group.launch" />
    </group>
    <group if="$(eval arg('simulator') == 'real' and arg('i_would_like_to_launch_sim_separately') == 'true')">
      <include file="$(find panda_launch)/launch/start_robot.launch" />
    </group>
    <group if="$(eval arg('simulator') == 'coppelia' and arg('i_would_like_to_launch_sim_separately') == 'true')">
      <include file="$(find mirracle_gestures)/launch/demo_coppelia.launch" />
      <node pkg="mirracle_gestures" name="coppelia_test" type="coppelia_test.py" output="screen"/>
    </group>



    <!-- There will be pick to three .config files no gripper/gripper/custom gripper -->
    <group if="$(eval arg('ik_solver') == 'relaxed_ik')">
      <arg name="config_file_name" value="relaxedIK.config" />
      <param name="config_file_name" value="$(arg config_file_name)"/>
      <node pkg="relaxed_ik" type="relaxed_ik_node.py" name="relaxed_ik_node" output="screen"/>
    </group>

    <node pkg="mirracle_gestures" name="apply_scene_service" type="apply_scene_service.py" output="screen"/>
    <node pkg="mirracle_gestures" name="main" type="main.py" output="screen"/>
    <node pkg="mirracle_gestures" name="sample_send" type="sample_send.py" output="screen"/>
</launch>
