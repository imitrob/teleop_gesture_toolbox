import roboticstoolbox as rtb
import spatialmath as sm
import swift
import numpy as np
import spatialgeometry as sg

class Swift():
    def __init__(self):
        self.env = swift.Swift()
        self.env.launch(realtime=True)

        self.panda = rtb.models.Panda()
        self.panda.base = sm.SE3.Ty(0.0)
        self.env.add(self.panda)

        self.ee_ax = sg.Axes(0.1, base=self.panda.fkine(self.panda.q))
        self.goal_ax = sg.Axes(0.1, base=sm.SE3(0.3, 0.6, 0.5) * sm.SE3.Rx(np.pi))
        self.env.add(self.ee_ax)
        self.env.add(self.goal_ax)

        self.arrived = False
        self.dt = 0.05

        self.panda.q = [0, -0.3, 0, -2.2, 0, 2.0, np.pi / 4]
        self.env.step(0)

        self.gripper_goal = 0.0
        self.trajectory_goal = []

        self.scene_objects = {}

    def add_trajectory(self, path):
        path = np.array(path)
        if path.any():
            self.trajectory_goal.extend(path)

    def step_path(self):
        self.ee_ax.base = self.panda.fkine(self.panda.q)
        J = self.panda.jacobe(self.panda.q)
        J_inv = np.linalg.pinv(J)
        ev, arrived = rtb.p_servo(self.panda.fkine(self.panda.q), self.goal_ax.base, gain=1.0, threshold=0.05)#0.001)
        self.panda.qd = J_inv @ ev

        if arrived:
            if self.trajectory_goal: # set new point
                point = self.trajectory_goal.pop(0)
                self.goal_ax.base = sm.SE3(*point) * sm.SE3.Rx(np.pi)

    def set_gripper(self, value):
        assert 0.0 <= value <= 1.0, f"Wrong value on input, should be between 0-1, it is {value}"
        self.gripper_goal = value

    def step_gripper(self):
        # value now
        q_now = self.panda.grippers[0]._q[0]
        # value goal
        q_goal = self.gripper_goal * 0.05 # ratio to centimeters
        # calc. move value
        max_speed = 0.05*self.dt
        q_move = np.clip(q_goal - q_now, -max_speed, max_speed)
        # apply the move onto current value
        q_now += q_move
        # rewrite register
        self.panda.grippers[0]._q = np.array([q_now,q_now])

    def step(self):
        self.step_gripper()
        self.step_path()
        self.env.step(self.dt)

    def add_or_edit_object(self, name=None, frame_id=None, size=None, color=None, pose=None, shape=None, mass=None, friction=None, inertia=None, inertiaTransformation=None, dynamic=None, pub_info=None, texture_file=None):
        '''
        not handled: frame_if, color, pose.orientiaton, shape, mass, friction, inertia, intertiaTransofrm, dynamic, pub_info, texture_file
        '''
        if not size: size = 0.05
        if isinstance(size, (int,float)): size = [size,size,size]

        self.scene_objects[name] = sg.Cuboid(
            size,
            base=sm.SE3(*[pose.position.x, pose.position.y, pose.position.z]) * sm.SE3.Rx(np.pi),
            color=[0.0, 1.0, 0.0, 1.0]
        )
        print("heehee", pose.position, size, name)
        self.env.add(self.scene_objects[name])

    def remove_object(self, name):
        self.env.remove(self.scene_objects[name])
        del self.scene_objects[name]
        print("object removed ", name)

if __name__ == '__main__':
    swft = Swift()

    from geometry_msgs.msg import Pose, Point
    pose = Pose()
    pose.position = Point(0.4,0.15,0.04)
    swft.add_or_edit_object(name='box', pose=pose)
    swft.scene_objects['box'].__dict__
    swft.trajectory_goal
    for _ in range(10):
        swft.step()

    swft.set_gripper(0.0)

    #swft.trajectory([(0.4, 0.0, 0.3),(0.6, 0.0, 0.3),(0.4, 0.0, 0.3)])
    #swft.new((0.4, 0.0, 0.3))

    #swft.stepping()

    swft.panda.__dict__

    swft.add_trajectory([[ 0.45660701, -0.03497654,  0.25430629],
 [ 0.45656446, -0.03517538,  0.25439763],
 [ 0.45652134, -0.03537437,  0.25448196],
 [ 0.45647972, -0.03557179,  0.25456775],
 [ 0.45643801, -0.03576861,  0.25465176],
 [ 0.45639952, -0.03596453,  0.25472892],
 [ 0.45636063, -0.03615952,  0.25480719],
 [ 0.45632287, -0.03635061,  0.2548813 ],
 [ 0.45628563, -0.03654133,  0.25495052],
 [ 0.45625052, -0.03672939,  0.25502147],
 [ 0.45621634, -0.03691609,  0.25508741],
 [ 0.45618283, -0.03709941,  0.25514921],
 [ 0.45615194, -0.0372792,   0.25520795],
 [ 0.45612111, -0.03745696,  0.25526285],
 [ 0.45609256, -0.03763114,  0.25531649],
 [ 0.45606568, -0.03780115,  0.25536105],
 [ 0.45604056, -0.03796791,  0.25540408],
 [ 0.45601636, -0.03813031,  0.25544387],
 [ 0.45599474, -0.03828889,  0.2554762 ],
 [ 0.45597392, -0.03844254,  0.25550864],
 [ 0.45595653, -0.0385928,   0.2555328 ],
 [ 0.45593997, -0.03873713,  0.25555241],
 [ 0.45592522, -0.03887686,  0.25556641],
 [ 0.45591251, -0.03901199,  0.25557804],
 [ 0.45590338, -0.03914005,  0.2555803 ],
 [ 0.4558946,  -0.03926207,  0.25558205],
 [ 0.45588838, -0.03938047,  0.25557585],
 [ 0.45588453, -0.03949176,  0.25556509],
 [ 0.45588345, -0.03959803,  0.25554787],
 [ 0.45588402, -0.03969656,  0.25552778],
 [ 0.45588658, -0.03979033,  0.2555007 ],
 [ 0.45589251, -0.03987501,  0.2554642 ],
 [ 0.45590108, -0.03995558,  0.25542659],
 [ 0.4559105,  -0.04002817,  0.25537972],
 [ 0.4559233,  -0.04009433,  0.25533059],
 [ 0.45593901, -0.0401536,   0.25527452],
 [ 0.45595631, -0.04020507,  0.25521126],
 [ 0.45597711, -0.04024921,  0.25514586],
 [ 0.45600021, -0.0402869,   0.25507073],
 [ 0.45602605, -0.04031622,  0.25499046],
 [ 0.45605459, -0.04033897,  0.25490608],
 [ 0.45608499, -0.04035388,  0.25481358],
 [ 0.45611818, -0.04036247,  0.25471977],
 [ 0.45615429, -0.04036274,  0.25461635],
 [ 0.45619335, -0.04035551,  0.25450859],
 [ 0.4562357,  -0.04034137,  0.25439673],
 [ 0.45627974, -0.04031824,  0.25427918],
 [ 0.45632677, -0.040289,    0.25415817],
 [ 0.45637541, -0.04025281,  0.25403076],
 [ 0.45642785, -0.04020912,  0.25389618],
 [ 0.45648274, -0.04015655,  0.25375777],
 [ 0.45653958, -0.04009851,  0.2536157 ],
 [ 0.45659991, -0.04003297,  0.25347013],
 [ 0.45666219, -0.03996063,  0.25331894],
 [ 0.45672619, -0.03988101,  0.25316805],
 [ 0.4567938,  -0.0397942,   0.25300723],
 [ 0.45686381, -0.03970173,  0.25284688],
 [ 0.45693606, -0.03960199,  0.25268054],
 [ 0.4570099,  -0.03949616,  0.2525138 ],
 [ 0.45708658, -0.03938442,  0.25233938],
 [ 0.45716438, -0.03926649,  0.25216737],
 [ 0.45724633, -0.03914092,  0.25198911],
 [ 0.45732988, -0.03901231,  0.25181071],
 [ 0.45741464, -0.03887705,  0.25163009],
 [ 0.45750197, -0.03873627,  0.25144634],
 [ 0.45759122, -0.03858978,  0.25126288],
 [ 0.45768259, -0.03843875,  0.25107567],
 [ 0.45777604, -0.03828441,  0.25089128],
 [ 0.45786923, -0.03812306,  0.25070384],
 [ 0.45796553, -0.03795973,  0.25051233],
 [ 0.45806338, -0.03779097,  0.25032519],
 [ 0.4581634,  -0.0376185,   0.25013693],
 [ 0.45826343, -0.03744311,  0.24994668],
 [ 0.45836615, -0.03726366,  0.24976173],
 [ 0.4584683,  -0.03708043,  0.24957418],
 [ 0.45857288, -0.03689578,  0.2493874 ],
 [ 0.45867869, -0.03670802,  0.24920107],
 [ 0.45878507, -0.03651713,  0.24902003],
 [ 0.45889272, -0.03632374,  0.24883827],
 [ 0.45900095, -0.03612893,  0.24865628],
 [ 0.45910965, -0.03593272,  0.24848094],
 [ 0.45921929, -0.0357352,   0.24830418],
 [ 0.45932902, -0.03553611,  0.2481336 ],
 [ 0.45943897, -0.03533577,  0.24796425],
 [ 0.45954895, -0.03513388,  0.24779672],
 [ 0.45966007, -0.03493236,  0.24763395],
 [ 0.45977173, -0.03472894,  0.24747528],
 [ 0.45988229, -0.03452721,  0.24731637],
 [ 0.45999315, -0.03432476,  0.24716297],
 [ 0.46010307, -0.03412333,  0.24701781],
 [ 0.46021327, -0.03392091,  0.2468747 ],
 [ 0.46032374, -0.03371937,  0.24673568],
 [ 0.46043319, -0.03351926,  0.24659791],
 [ 0.46054265, -0.0333202,   0.24647143],
 [ 0.46064957, -0.03312124,  0.24634296],
 [ 0.46075777, -0.03292458,  0.24622395],
 [ 0.46086348, -0.03272948,  0.24610323],
 [ 0.46096831, -0.03253456,  0.24599742],
 [ 0.46107324, -0.03234289,  0.24589181],
 [ 0.46117658, -0.03215237,  0.24578983],
 [ 0.461277,   -0.0319636,   0.24569592],
 [ 0.46137886, -0.0317769,   0.24560419],
 [ 0.46147763, -0.03159316,  0.24551844],
 [ 0.46157507, -0.03141086,  0.24544223],
 [ 0.46167191, -0.03123042,  0.24536677],
 [ 0.46176523, -0.03105413,  0.24530008],
 [ 0.46185817, -0.03087862,  0.24523249],
 [ 0.46194832, -0.03070591,  0.24517495],
 [ 0.46203674, -0.03053534,  0.24512374],
 [ 0.4621241,  -0.03036848,  0.24507328],
 [ 0.46220805, -0.03020285,  0.24503196],
 [ 0.4622906,  -0.03004111,  0.24499261],
 [ 0.46237034, -0.02988015,  0.24495839],
 [ 0.46244939, -0.02972317,  0.24492815],
 [ 0.46252431, -0.02956851,  0.24490379],
 [ 0.46259802, -0.02941572,  0.24488726],
 [ 0.46266842, -0.0292663,   0.24487288],
 [ 0.4627368,  -0.0291183,   0.24486224],
 [ 0.46280323, -0.02897377,  0.24485321],
 [ 0.46286591, -0.02883112,  0.24485064],
 [ 0.46292604, -0.02869038,  0.24485296],
 [ 0.46298445, -0.02855238,  0.24485564],
 [ 0.46303909, -0.02841677,  0.24486622],
 [ 0.46309153, -0.02828249,  0.24487525],
 [ 0.46314097, -0.02815131,  0.24488997],
 [ 0.46318891, -0.02802015,  0.24490575],
 [ 0.46323139, -0.02789196,  0.24492347],
 [ 0.46327251, -0.02776388,  0.24494828],
 [ 0.46331131, -0.02763923,  0.24497242],
 [ 0.46334611, -0.0275157,   0.24499961],
 [ 0.4633781,  -0.0273923,   0.24502667],
 [ 0.4634079,  -0.0272712,   0.24505657],
 [ 0.46343419, -0.0271508,   0.24508649],
 [ 0.46345769, -0.02703151,  0.24511836],
 [ 0.46347837, -0.02691128,  0.24515073],
 [ 0.46349598, -0.02679331,  0.24518438],
 [ 0.46351048, -0.02667689,  0.24521722],
 [ 0.46352245, -0.02655952,  0.24525194],
 [ 0.46353151, -0.02644279,  0.24528387],
 [ 0.46353673, -0.02632518,  0.24531913],
 [ 0.4635404,  -0.02620872,  0.24535064],
 [ 0.46354018, -0.02609222,  0.24538531],
 [ 0.46353802, -0.02597527,  0.24541477],
 [ 0.46353157, -0.02585724,  0.24544453],
 [ 0.46352344, -0.02574068,  0.24547457],
 [ 0.46351267, -0.02562182,  0.24550231],
 [ 0.46349841, -0.02550304,  0.24552665],
 [ 0.4634827,  -0.02538261,  0.24554937],
 [ 0.46346339, -0.02526169,  0.24557133],
 [ 0.46344049, -0.02513969,  0.24559129],
 [ 0.46341779, -0.0250167,   0.24560806],
 [ 0.46338956, -0.0248924,   0.24562052],
 [ 0.46336029, -0.0247671,   0.24563438],
 [ 0.4633286,  -0.02463988,  0.24564285],
 [ 0.46329379, -0.02451108,  0.24564857],
 [ 0.46325746, -0.02438081,  0.24564945],
 [ 0.46321723, -0.02424967,  0.24564896],
 [ 0.46317646, -0.02411595,  0.24564634],
 [ 0.46313308, -0.02398088,  0.2456377 ],
 [ 0.46308686, -0.02384392,  0.24562572],
 [ 0.46303875, -0.02370468,  0.24561246],
 [ 0.46298876, -0.02356369,  0.24559136],
 [ 0.46293711, -0.02342116,  0.24556812],
 [ 0.46288395, -0.02327602,  0.24554457],
 [ 0.46282826, -0.02312931,  0.24551193],
 [ 0.46277002, -0.02298026,  0.24547744],
 [ 0.46271201, -0.02282867,  0.24544057],
 [ 0.46265077, -0.02267643,  0.24539756],
 [ 0.46258869, -0.02252119,  0.2453491 ],
 [ 0.46252501, -0.02236419,  0.24529937],
 [ 0.46246065, -0.0222051,   0.2452433 ],
 [ 0.4623926,  -0.0220433,   0.24518336],
 [ 0.46232462, -0.0218807,   0.24512068],
 [ 0.46225504, -0.0217152,   0.24505395],
 [ 0.46218488, -0.02154781,  0.24498333],
 [ 0.46211319, -0.02137809,  0.24490449],
 [ 0.46204075, -0.02120668,  0.24482736],
 [ 0.46196663, -0.02103406,  0.24474103],
 [ 0.46189222, -0.02085955,  0.24465611],
 [ 0.46181657, -0.02068309,  0.24456381],
 [ 0.46174123, -0.02050528,  0.24447045],
 [ 0.46166387, -0.0203241,   0.24437365],
 [ 0.46158651, -0.02014302,  0.24426962],
 [ 0.46150814, -0.0199607,   0.24416561],
 [ 0.46142951, -0.01977661,  0.24405547],
 [ 0.46135162, -0.01959016,  0.24394593],
 [ 0.46127082, -0.01940438,  0.24382694],
 [ 0.46119089, -0.0192158,   0.24370927],
 [ 0.46111178, -0.01902657,  0.24358811],
 [ 0.46103043, -0.0188371,   0.24346252],
 [ 0.46095032, -0.01864568,  0.24333844],
 [ 0.46086969, -0.01845306,  0.24320591],
 [ 0.46078973, -0.01826044,  0.24307592],
 [ 0.46070796, -0.01806775,  0.24293844],
 [ 0.46062766, -0.01787443,  0.24280088],
 [ 0.46054752, -0.01767947,  0.24265944],
 [ 0.46046702, -0.01748528,  0.24252133],
 [ 0.46038639, -0.01728995,  0.24237747],
 [ 0.46030682, -0.01709411,  0.24223195],
 [ 0.4602274,  -0.01689904,  0.24208619]])

    swft.add_trajectory([[-9.86481072e-01,  1.23494050e+02, -9.63208891e+00],
 [ 3.35757852e+00, -9.59279366e+00,  6.49208996e+00],
 [ 2.94064737e+00, -1.13978554e+01,  5.95566589e+00],
 [-1.75287542e+00,  1.82518456e+02,  4.59787764e+00],
 [ 3.73888304e+00,  3.75270809e+01,  6.28437880e+00],
 [ 9.75047683e+00, -2.56626925e+00,  1.09758298e+01],
 [-1.39083362e+00,  1.61308054e+01,  1.84081421e+01],
 [ 1.30854734e+01,  5.76846089e+01,  1.55798693e+01],
 [ 1.01527133e+01,  1.27179741e+02,  1.73613420e+01],
 [ 1.03715864e+01,  5.70054799e+01,  1.09094365e+01],
 [ 1.95029543e+01,  6.26703404e+01,  2.35709350e+01],
 [ 1.18207006e+01,  7.49778021e+01,  2.26917577e+01],
 [ 1.69150168e+01,  1.72364803e+01,  1.80566037e+01],
 [ 5.55917883e+00,  3.69892376e+01,  2.30405598e+01],
 [ 1.19904104e+01,  1.16558227e+02,  2.30980083e+01],
 [ 1.66721699e+01, -7.40538246e+01,  2.67621460e+01],
 [ 4.62798562e+00, -1.83802018e+01,  3.23231192e+01],
 [ 2.18402489e+01,  1.73386916e+02,  3.44950626e+01],
 [ 1.31791558e+01,  5.10085012e+01,  4.13332068e+01],
 [ 1.58926477e+01,  1.26414489e+02,  3.79480712e+01],
 [ 2.12577274e+01,  1.00336530e+02,  3.18935925e+01],
 [ 2.33845081e+01,  1.57120622e+02,  4.86933184e+01],
 [ 1.55003195e+01,  1.94333617e+01,  3.91280579e+01],
 [ 2.49688229e+01,  6.63946005e+00,  3.76342959e+01],
 [ 2.02222953e+01,  7.04826938e+01,  4.96462468e+01],
 [ 2.18650011e+01,  1.85333742e+02,  4.21995769e+01],
 [ 2.10140835e+01,  9.25840937e+01,  4.58167951e+01],
 [ 1.77255208e+01,  9.76880166e+01,  4.17710858e+01],
 [ 2.15249090e+01, -1.14928961e+02,  4.58718762e+01],
 [ 1.73390359e+01,  3.94246082e+01,  3.82730648e+01],
 [ 2.03580843e+01, -6.12974308e+01,  5.16558005e+01],
 [ 2.56740247e+01, -8.77698768e+00,  4.51620086e+01],
 [ 2.37051648e+01, -5.22343475e+01,  4.87763895e+01],
 [ 2.07752785e+01,  1.64159124e+01,  4.96202107e+01],
 [ 1.86809197e+01, -4.17173284e+01,  5.01858946e+01],
 [ 2.66905860e+01, -1.23050353e+02,  3.94444000e+01],
 [ 2.23498148e+01, -6.91591637e+00,  7.05681846e+01],
 [ 1.97082433e+01,  1.39364352e+02,  6.13443053e+01],
 [ 2.88063559e+01, -6.09690289e+01,  5.93670087e+01],
 [ 2.32808356e+01,  1.01454505e+02,  6.90594442e+01],
 [ 2.82124598e+01, -1.34410326e+02,  5.42226928e+01],
 [ 1.82768158e+01,  6.76003662e+01,  7.16703775e+01],
 [ 1.92478980e+01,  3.03045150e+01,  6.30988417e+01],
 [ 2.28946914e+01, -6.99064431e+01,  5.85529698e+01],
 [ 2.99157976e+01,  2.56844208e+01,  5.80004720e+01],
 [ 2.88520223e+01, -1.68252450e+01,  5.60637114e+01],
 [ 2.61529512e+01, -3.46393070e+01,  6.31340326e+01],
 [ 2.44623860e+01, -1.58944685e+01,  6.31605636e+01],
 [ 1.60629136e+01,  2.53110938e+01,  5.50655942e+01],
 [ 2.94303913e+01, -5.95488747e+01,  6.65662819e+01],
 [ 2.61318261e+01, -1.62355399e+02,  5.51033056e+01],
 [ 2.21891633e+01, -7.10983660e+01,  4.73586216e+01],
 [ 2.41545940e+01,  6.60200466e+01,  5.22540004e+01],
 [ 3.02240540e+01, -5.79667807e+01,  5.13384151e+01],
 [ 2.35210227e+01,  2.11214602e+01,  6.28117326e+01],
 [ 1.87662766e+01, -3.98166390e+01,  5.91327246e+01],
 [ 1.25802569e+01, -2.30391138e+01,  6.76948336e+01],
 [ 2.85887533e+01, -3.59680866e+01,  6.23146091e+01],
 [ 2.04115526e+01,  2.65571985e+01,  5.92204190e+01],
 [ 2.11333703e+01, -1.76218218e+01,  5.94372020e+01],
 [ 1.87397223e+01, -6.58319619e+01,  6.01172392e+01],
 [ 1.86413979e+01, -1.95113330e+01,  5.59222576e+01],
 [ 1.96406516e+01, -1.01422004e+02,  5.01887179e+01],
 [ 1.14297730e+01, -1.01451585e+02,  5.57626948e+01],
 [ 1.94082162e+01, -1.45314523e+02,  6.11939643e+01],
 [ 1.80188871e+01, -4.95112086e+01,  5.78284923e+01],
 [ 1.84953328e+01, -1.41088258e+02,  5.06712025e+01],
 [ 1.66928525e+01, -8.89579311e+01,  5.85917794e+01],
 [ 1.18843215e+01, -1.75057827e+02,  5.19159348e+01],
 [ 9.26331025e+00, -1.22301256e+02,  5.96386172e+01],
 [ 9.85833395e+00, -1.51982432e+02,  4.85601728e+01],
 [ 8.32990647e+00, -1.17639702e+02,  5.31030114e+01],
 [ 1.12348840e+01, -2.07748948e+02,  4.60486799e+01],
 [ 5.62824168e+00, -1.40316086e+02,  4.70928584e+01],
 [ 5.06597017e+00, -1.77094946e+02,  4.09640843e+01],
 [ 9.90360543e+00, -2.07480599e+02,  3.78780272e+01],
 [ 6.86747161e+00, -1.76627739e+02,  3.76029845e+01],
 [ 4.80478471e+00, -6.63194889e+01,  4.91151029e+01],
 [ 7.03355427e+00, -5.34005939e+01,  4.46717556e+01],
 [-1.55778967e-01, -1.43460239e+02,  3.71560044e+01],
 [ 2.68750611e+00, -1.08211311e+02,  4.05781026e+01],
 [ 3.07160300e+00, -8.50026427e+01,  3.71675864e+01],
 [-6.92240751e+00, -1.21754114e+02,  4.53307808e+01],
 [-1.95601080e-01, -2.71421245e+02,  3.85742306e+01],
 [ 2.31686618e+00, -2.39978091e+02,  3.55179324e+01],
 [-7.51809444e+00, -1.59703985e+02,  3.41501151e+01],
 [-2.81467673e+00, -9.59124126e+01,  2.93176545e+01],
 [-7.13567599e+00, -1.52188547e+02,  3.32113968e+01],
 [-3.60976642e+00, -2.42690271e+02,  2.39454652e+01],
 [-9.21515971e+00, -2.90320276e+02,  2.11910077e+01],
 [-1.13631934e+01, -1.96417917e+02,  3.45531826e+01],
 [-8.29374748e+00, -2.03492606e+02,  1.46208514e+01],
 [-8.44307653e+00, -2.62844721e+02,  2.72917485e+01],
 [-5.62552991e+00, -2.14589405e+02,  2.39112690e+01],
 [-8.87165978e+00, -1.62479869e+02,  2.17566668e+01],
 [-6.55594065e+00, -1.66654772e+02,  2.04980352e+01],
 [-3.71014775e-01, -1.61377948e+02,  2.29091270e+01],
 [-2.19027887e+00, -3.51116585e+02,  1.95659412e+01],
 [-1.23673573e+01, -3.27291161e+02,  1.06893015e+01],
 [-4.97471060e+00, -2.94604761e+02,  2.67260721e+01],
 [-1.06842370e+01, -1.72819922e+02,  2.57281948e+01],
 [-4.28473046e+00, -1.81785507e+02,  1.10246361e+01],
 [-1.39433930e+01, -2.16323309e+02,  1.35905489e+01],
 [-9.70031180e+00, -1.43673196e+02,  1.62515578e+01],
 [-8.26397660e+00, -1.91613786e+02,  5.12883935e+00],
 [-1.66082287e+01, -1.05830916e+02,  9.58545849e+00],
 [ 1.49678776e+00, -2.81393969e+02,  9.62142395e+00],
 [-1.55191857e+01, -2.69026210e+02,  1.10664823e+01],
 [-1.80321678e+01, -1.72876238e+02,  1.28015954e+01],
 [-1.47649509e+01, -2.13132198e+02,  1.43214569e+01],
 [-1.41161695e+01, -2.16384369e+02,  9.65027018e+00],
 [-1.00882154e+01, -8.40063670e+01,  1.02736505e+01],
 [-1.59753917e+01, -1.34063455e+02,  1.48892601e+01],
 [-1.94056210e+01, -1.17008088e+02,  9.00376406e-01],
 [-1.71154848e+01, -2.34269672e+02, -7.19388899e-01],
 [-1.61022398e+01, -6.32932567e+01, -5.04883039e+00],
 [-1.66782366e+01, -1.87547654e+02,  3.94056525e+00],
 [-1.13036174e+01, -1.35521781e+02, -7.73638934e+00],
 [-5.66173294e+00, -1.59410408e+02,  4.44929388e+00],
 [-1.46431113e+01, -2.45838418e+02, -3.28687851e+00],
 [-1.29491646e+01, -1.82783242e+02,  3.70509768e+00],
 [-1.10343965e+01, -1.34009006e+02,  6.60339024e+00],
 [-8.46572880e+00, -1.97384413e+02, -1.14997493e+01],
 [-1.05177044e+01, -1.03268920e+02, -1.96781342e+00],
 [-1.20294455e+01, -1.05123326e+02, -3.68940332e-01],
 [-2.22169507e+01, -8.14841353e+01, -2.46866051e+00],
 [-1.63015310e+01, -1.35876266e+02,  2.76863616e+00],
 [-1.08940559e+01, -2.48157826e+02, -2.23251314e-01],
 [-1.74099165e+01, -1.74752909e+02, -2.07321479e+00],
 [-9.26159312e+00, -1.32958366e+02, -6.61766800e+00],
 [-1.35818914e+01, -7.02605691e+01, -9.31439178e-01],
 [-1.73766549e+01, -1.43033267e+02, -3.53643585e+00],
 [-5.95819950e+00, -1.40356798e+02, -2.49410746e+00],
 [-1.21519160e+01, -1.32086365e+02, -5.90440021e+00],
 [-8.23109514e+00, -9.77713287e+01,  3.47101395e-01],
 [-1.91139165e+00, -5.92730103e+01, -5.74392555e+00],
 [-1.40984734e+01, -1.29397144e+02, -8.94474638e+00],
 [-1.42618697e+01, -1.16544283e+02, -4.22355688e+00],
 [-9.78751242e+00, -4.12576006e+01, -2.26336850e+00],
 [-8.61118842e+00, -4.03792721e+01, -2.18735344e+00],
 [-1.05255253e+01, -4.37018584e+01, -1.16732252e+01],
 [-3.00449662e+00, -1.29245342e+01,  2.31416655e-01],
 [-1.54798061e+01, -4.69157761e+01, -9.20856233e+00],
 [-2.05022951e+00, -1.95568071e+02,  3.81988360e+00],
 [-6.40683067e+00, -5.68861115e+01, -3.89682944e+00],
 [-1.40494417e+00, -9.61184313e+01, -1.18911903e+01],
 [-9.85754518e+00, -5.01372589e+01, -9.10210691e+00],
 [-3.75685678e+00,  3.89799039e+01, -6.78231516e+00],
 [-1.33610406e+01, -3.53958858e+01,  1.33316197e-01],
 [-8.41759106e+00,  2.57682753e+01, -7.37376972e+00],
 [-4.73311355e+00,  7.23958704e+01, -4.38754580e+00],
 [-6.11071342e+00,  6.35381237e+01, -1.00329009e+01],
 [-8.49494807e+00, -1.53048910e+01, -1.12619424e+01],
 [-3.77904541e+00,  3.06426336e+01, -4.91831042e+00],
 [-1.47010622e+00, -2.03730957e+01, -9.14040235e+00],
 [ 6.04576832e+00,  2.74691460e+01, -4.40583363e+00],
 [-2.65209986e+00,  5.19676392e+01, -1.38079319e+01],
 [-3.61327459e+00,  1.44718238e+02, -7.62403342e+00],
 [-9.92993754e-02, -1.00056488e+02, -5.34589587e+00],
 [-9.21203368e+00, -1.13512558e+02, -1.62334811e+01],
 [-6.53931221e+00,  2.08607558e+01,  1.93278924e+00],
 [ 4.64057502e+00,  7.23120919e+01, -9.78311335e+00],
 [-4.97268762e+00,  9.52441539e+01,  3.42275058e+00],
 [-3.44350996e-01, -8.24029150e+01, -1.62354796e+00],
 [ 7.00169879e-01,  2.05125149e+01,  1.87960055e+00],
 [ 2.60897094e+00,  1.69109079e+01, -4.76624373e+00],
 [-7.47119470e+00,  1.12556026e+02,  6.70394290e+00],
 [-4.66728914e-01,  1.85957629e+02, -2.05991181e+00],
 [ 4.14534848e+00, -4.70059605e+01,  4.10524619e+00],
 [ 1.27068471e+01,  7.85292864e+01, -4.23326390e+00],
 [ 4.22716002e+00,  4.73537461e+01,  8.42229621e-01],
 [ 1.52163105e+00, -6.33316076e+00, -1.83894254e+00],
 [ 1.68595515e+00,  7.89062169e+01, -3.83581644e+00],
 [-3.45042610e+00,  1.08947389e+02, -5.37749371e+00],
 [ 1.73397631e-01,  9.65132895e+01, -3.47246101e+00],
 [ 2.52515376e+00,  1.42027756e+02,  5.39743815e+00],
 [-4.89676256e+00,  1.46281952e+02,  5.78959533e+00],
 [-4.32420961e+00,  4.72691550e+01,  1.11066900e-01],
 [ 5.42273840e+00, -6.60854839e+01,  2.99247587e+00],
 [ 4.46690569e-01,  2.93716970e+01, -1.42669671e+00],
 [-1.57846969e+00,  2.69890304e+01, -1.32344483e+01],
 [ 1.29116756e+00,  2.23109937e+01,  1.00451262e+01],
 [ 4.27665953e+00,  5.69253778e+01, -8.47682046e+00],
 [-1.29371910e-01,  9.67057667e+01,  3.98800158e+00],
 [-5.46799811e+00,  8.00254021e+01,  1.13994453e+00],
 [ 4.40624924e-01,  6.85097710e+01,  1.10671332e+01],
 [ 2.05374889e+00,  6.19492369e+01, -2.42197123e+00],
 [ 2.55064437e+00,  2.99278619e+01,  7.01427341e-02],
 [ 7.43968586e-01,  6.09906599e+01, -4.33049336e+00],
 [-5.51659881e-01,  7.05889985e+01,  4.46678902e+00],
 [-7.20128953e+00,  1.38233446e+02,  1.14139279e+00],
 [ 3.76109474e+00,  8.15144295e+01, -6.89828549e+00],
 [ 4.41212213e+00,  6.79952253e+01, -7.50182645e+00],
 [-2.70337826e+00,  1.44654869e+01, -1.41766602e+00],
 [-1.12911289e+01, -2.40422982e+00, -3.66324247e+00],
 [-9.58163751e-01,  3.17681547e+01,  1.12315636e+01],
 [ 1.32291593e-01,  9.57741189e+00,  2.55096165e+00],
 [-4.05530491e+00,  5.87181870e+00,  1.42683648e+00],
 [ 2.42475075e+00,  1.53909086e+01,  4.63502968e+00],
 [-3.72032614e+00, -1.13957224e+02,  2.45657125e+00]])






#
